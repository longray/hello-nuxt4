# Nuxt4 配置文件（nuxt.config.ts）详解
标签: Nuxt4, 配置, nuxt.config, TypeScript

## 问题描述
`nuxt.config.ts` 文件是 Nuxt4 项目的“大脑”，它控制着从路由、渲染模式到模块、插件等方方面面的行为。如何正确理解和配置这个文件，对于高效开发和项目优化至关重要。

## 解决方案
`nuxt.config.ts` 文件导出一个通过 `defineNuxtConfig` 函数定义的配置对象。这个函数提供了类型提示和自动补全，让配置过程更加安全和便捷。

### 核心配置选项
以下是一些最常用和最重要的配置选项：

- **`ssr`**: 布尔值，用于开启或关闭服务端渲染（Server-Side Rendering）。`true` (默认) 为同构渲染（Universal SSR），`false` 则为纯客户端渲染（SPA 模式）。
  ```typescript
  export default defineNuxtConfig({
    ssr: true, // 或者 false
  })
  ```

- **`app`**: 配置应用的元数据（meta tags）、头部链接（head links）、全局过渡效果等。
  ```typescript
  export default defineNuxtConfig({
    app: {
      head: {
        charset: 'utf-8',
        viewport: 'width=device-width, initial-scale=1',
        title: '我的神奇 Nuxt4 应用',
        meta: [
          { name: 'description', content: '一个用 Nuxt4 构建的超酷网站' }
        ],
      }
    }
  })
  ```

- **`modules`**: 数组类型，用于注册 Nuxt 模块。模块是扩展 Nuxt 核心功能的强大方式。
  ```typescript
  export default defineNuxtConfig({
    modules: [
      '@nuxtjs/tailwindcss', // 集成 TailwindCSS
      '@pinia/nuxt',         // 集成 Pinia 状态管理
    ]
  })
  ```

- **`css`**: 数组类型，用于全局注册 CSS 文件、Sass/Less 文件或 CSS 库。
  ```typescript
  export default defineNuxtConfig({
    css: [
      '~/assets/css/main.css', // 项目主样式文件
      '@/assets/scss/variables.scss', // 全局 Sass 变量
    ]
  })
  ```

- **`runtimeConfig`**: 用于管理环境变量和运行时配置。这里的配置可以在服务端和客户端安全地访问，是处理敏感信息（如 API 密钥）的最佳实践。
  ```typescript
  export default defineNuxtConfig({
    runtimeConfig: {
      // 只在服务端可用的私有密钥
      apiSecret: 'my-secret-key',
      // public 部分的配置在客户端和服务端都可用
      public: {
        apiBase: '/api'
      }
    }
  })
  ```

- **`vite`**: 用于深度定制底层的 Vite 构建工具。例如，配置 Vite 插件、优化构建选项等。
  ```typescript
  import svgLoader from 'vite-svg-loader'

  export default defineNuxtConfig({
    vite: {
      plugins: [
        svgLoader() // 添加一个 Vite 插件来处理 SVG 文件
      ]
    }
  })
  ```

## 示例代码
一个相对完整的 `nuxt.config.ts` 文件示例，展示了多个常用配置的组合：
```typescript
// nuxt.config.ts
import { defineNuxtConfig } from 'nuxt/config'

export default defineNuxtConfig({
  // 开启开发者工具
  devtools: { enabled: true },

  // 关闭服务端渲染，切换到 SPA 模式
  ssr: false,

  // 注册模块
  modules: [
    '@nuxtjs/tailwindcss',
    '@pinia/nuxt',
  ],

  // 全局 CSS
  css: ['~/assets/css/tailwind.css'],

  // 应用元数据
  app: {
    head: {
      title: 'Nuxt4 知识库',
      meta: [
        { name: 'description', content: '一个全面的 Nuxt4 学习资源库' }
      ],
      link: [
        { rel: 'icon', type: 'image/x-icon', href: '/favicon.ico' }
      ]
    }
  },

  // 运行时配置
  runtimeConfig: {
    public: {
      gtagId: 'G-XXXXXXXXXX' // 谷歌分析 ID
    }
  },

  // 针对特定模块的配置
  tailwindcss: {
    cssPath: '~/assets/css/tailwind.css',
    configPath: 'tailwind.config.js',
  }
})
```

## 常见坑点与注意事项
- **类型安全**: 务必使用 `defineNuxtConfig` 来包裹你的配置对象，这样可以获得完整的 TypeScript 类型支持，避免拼写错误和无效配置。
- **`runtimeConfig` vs `app.head`**: `runtimeConfig` 用于管理**运行时**的环境变量，而 `app.head` 用于定义**构建时**的静态元数据。不要混淆两者的用途。
- **模块顺序**: 某些模块的加载顺序可能很重要。如果遇到问题，尝试调整它们在 `modules` 数组中的顺序。
- **重启开发服务器**: 修改 `nuxt.config.ts` 后，通常需要重启开发服务器（`npm run dev`）才能让更改生效。

## 参考链接
- [Nuxt4 官方文档 - `nuxt.config.ts`](https://nuxt.com/docs/api/configuration/nuxt-config)
- [Nuxt4 官方文档 - 运行时配置](https://nuxt.com/docs/guide/going-further/runtime-config)